"""
Language management for ResourceChecker application.

Provides internationalization support for English and Turkish languages.
"""

import os
import json


# Global language dictionary
LANGUAGE_DICT = {
    'en': {
        # Main Window
        'main_title': 'Resource Checker - System Monitor',
        'settings_frame': 'Settings',
        'system_interval': 'System Monitoring Period (seconds):',
        'network_interval': 'Network Check Period (seconds):',
        'top_apps_count': 'Top consuming apps count:',
        'auto_log': 'Auto Log Save',
        'webhook_settings': 'üîî Webhook Settings',
        'start_monitoring': 'Start Monitoring',
        'stop_monitoring': 'Stop Monitoring',
        'network_health_check': 'Network Health Check',
        'auto_network_monitoring': 'Auto Network Monitoring',
        'stop_auto_network': 'Stop Auto Network Monitoring',
        'resource_temp_monitor': 'Resource & Temp Monitor',
        'cpu_stress_test': 'CPU Stress Test',
        'system_info_frame': 'System Information',
        'cpu_usage': 'CPU Usage: --',
        'ram_usage': 'RAM Usage: --',
        'network_status': 'Network Status: --',
        'top_cpu_apps': 'Top CPU Consuming Apps',
        'top_network_apps': 'Top Network Consuming Apps',
        'system_logs': 'System Log Records',
        'network_logs': 'Network Log Records',
        'clear_system_logs': 'Clear System Logs',
        'export_system_logs': 'Export System Logs',
        'clear_network_logs': 'Clear Network Logs',
        'export_network_logs': 'Export Network Logs',
        
        # Resource & Temperature Monitor
        'resource_temp_title': 'Resource & Temperature Monitor',
        'log_settings': 'Log Settings',
        'enable_logging': 'Enable Log Recording',
        'log_interval': 'Log Interval (sec):',
        'log_status_active': 'Log: Active',
        'log_status_inactive': 'Log: Inactive',
        'open_log_folder': 'üìÅ Open Log Folder',
        'cpu_header': 'CPU',
        'gpu_header': 'GPU',
        'ram_header': 'RAM',
        'usage': 'Usage: - %',
        'temperature': 'Temperature: - ¬∞C',
        'min_temp': 'Min: - ¬∞C',
        'max_temp': 'Max: - ¬∞C',
        'usage_percent': 'Usage (%): - %',
        'usage_mb': 'Usage (MB): - / - MB',
        'gpu_util_not_available': 'GPUtil library not installed.',
        'gpu_install_hint': 'pip install gputil',
        
        # CPU Stress Test
        'stress_test_title': 'CPU Stress Test',
        'core_count': 'Number of Cores to Use:',
        'start_test': 'Start Test',
        'stop_test': 'Stop Test',
        'status_waiting': 'Status: Waiting',
        'status_running': 'Status: Running with {0} cores...',
        'status_stopped': 'Status: Stopped.',
        'performance_scores': 'Performance Scores',
        'current_score': 'Current Score: --',
        'average_score': 'Average Score: --',
        'max_score': 'Max Score: --',
        'test_duration': 'Test Duration: 00:00',
        
        # Standalone Stress Test
        'stress_standalone_title': 'CPU Stress Test',
        'core_count_label': 'Core Count:',
        'start_button': 'Start',
        'stop_button': 'Stop',
        'status_waiting_standalone': 'Status: Waiting',
        'status_running_standalone': 'Status: {0} processes running',
        'status_completed': 'Completed - Avg: {0:.0f}, Max: {1:.0f}',
        'status_stopped_standalone': 'Status: Stopped',
        'total_cpu': 'Total CPU: {0:.1f} %',
        'performance_frame': 'Performance',
        'current_label': 'Current: --',
        'average_label': 'Average: --',
        'max_label': 'Max: --',
        'duration_label': 'Duration: 00:00',
        'per_core_usage': 'Per-Core Usage (%):',
        
        # Log Messages
        'log_cleared': 'Log records cleared',
        'monitoring_started': 'Monitoring started - Update every {0} seconds',
        'monitoring_stopped': 'Monitoring stopped - Usage info reset',
        'network_monitoring_started': 'Auto network monitoring started - Every {0} seconds',
        'network_monitoring_stopped': 'Auto network monitoring stopped',
        'resource_monitor_opened': 'Resource & Temperature Monitor opened.',
        'stress_test_started': 'CPU Stress Test started with {0} cores.',
        'stress_test_stopped': 'CPU Stress Test stopped.',
        'stress_test_completed': 'CPU Stress Test completed. Duration: {0:02d}:{1:02d}, Avg Score: {2:.1f}, Max Score: {3:.1f}',
        'top_apps_updated': 'Top consuming apps count updated to {0}',
        'auto_logging_enabled': 'Auto log saving enabled: New file will be created when reaching 500KB(written every 1 minute)',
        'auto_logging_disabled': 'Auto log saving disabled - File writing stopped',
        'network_auto_logging_enabled': 'Auto network log saving enabled: New file will be created when reaching 500KB',
        'network_auto_logging_disabled': 'Auto network log saving disabled - File writing stopped',
        
        # Network Health
        'network_health_header': '=== Network Health Check ===',
        'health_check_completed': '=== Health Check Completed ===',
        'network_connection_error': 'NETWORK CONNECTION ERROR',
        'all_connections_ok': 'ALL NETWORK CONNECTIONS OK',
        'partial_connection': 'PARTIAL NETWORK CONNECTION ({0}/{1} OK)',
        'connection_ok': 'Network Connection OK',
        'connection_nok': 'NETWORK CONNECTION NOK ERROR',
        'partial_nok': 'NETWORK CONNECTION PARTIAL NOK ERROR',
        'host_status': 'HOST STATUS - {0}: {1}',
        'reachable': '‚úì Reachable',
        'unreachable': '‚úó Unreachable',
        
        # Dialogs and Messages
        'warning': 'Warning',
        'error': 'Error',
        'success': 'Success',
        'confirm': 'Confirm',
        'log_folder_not_found': 'Log Folder Not Found',
        'log_folder_message': 'Log folder does not exist.\n\nPlease start logging.',
        'log_folder_error': 'Error occurred while opening log folder: {0}',
        'export_success': 'Log file saved: {0}',
        'export_error': 'Error occurred while exporting log: {0}',
        
        # Language Toggle
        'language_english': 'English',
        'language_turkish': 'T√ºrk√ße',

        # --- Added: CPU Stress Test extra labels ---
        'per_core_score': 'Per-Core Score:',
        'sustainability': 'Sustainability:',
        'current_cpu_score': 'Current CPU Score: {0:.2f} MOp/s',
        'per_core_cpu_score': 'Per-Core Score: {0:.2f} MOp/s',
        'average_cpu_score': 'Average CPU Score: {0:.2f} MOp/s',
        'peak_cpu_score': 'Peak CPU Score: {0:.2f} MOp/s',
        'sustainability_value': 'Sustainability: {0:.1f}%',
        'test_duration_label': 'Test Duration: {0:02d}:{1:02d}',

        # --- Added: Webhook window labels/messages ---
        'webhook_window_title': 'Webhook Settings',
        'name_label': 'Name:',
        'url_label': 'URL:',
        'type_label': 'Type:',
        'active_label': 'Active',
        'threshold_label': 'Threshold (%):',
        'mode_add_new': 'Mode: Add New',
        'mode_editing': "Mode: Editing '{0}'",
        'add_new_btn': 'Add New',
        'save_changes_btn': 'Save Changes',
        'cancel_edit_btn': 'Cancel Edit',
        'send_test_btn': 'Send Test',
        'remove_selected_btn': 'Remove Selected',
        'close_btn': 'Close',
        'validation_title': 'Validation',
        'validation_name_url_required': 'Name and URL are required.',
        'duplicate_title': 'Duplicate',
        'duplicate_exists': "A webhook named '{0}' already exists. Select it to edit or use New for another.",
        'threshold_number_error': 'Threshold must be a number.',
        'duplicate_rename_error': "Another webhook named '{0}' already exists.",
        'test_title': 'Test',
        'test_select_warning': 'Select at least one webhook.',
        'test_results_title': 'Test Results',
        'test_results_message': 'Sent: {0}\nFailed: {1}',
        'test_message_title': 'üîî Test Webhook Message',
        'test_message_body': "This is a test message for webhook '{0}'.\n\nType: {1}\nActive: {2}\nTime: {3}",
        # --- Added: Network Settings Window ---
        'network_settings_title': 'Network Settings',
        'host_list_label': 'Test Hosts:',
        'host_name_label': 'Name:',
        'host_address_label': 'Address:',
        'add_host_btn': 'Add Host',
        'remove_host_btn': 'Remove Selected',
        'reset_hosts_btn': 'Reset Defaults',
        'close_window_btn': 'Close',
        'host_add_warning_title': 'Validation',
        'host_add_warning_msg': 'Name and address are required.',
        'host_remove_warning_title': 'Selection',
        'host_remove_warning_msg': 'Select at least one host to remove.',
        'hosts_reset_info_title': 'Reset',
        'hosts_reset_info_msg': 'Host list reset to defaults.',
    },
    'tr': {
        # Main Window
        'main_title': 'Resource Checker - System Monitor',
        'settings_frame': 'Ayarlar',
        'system_interval': 'Sistem ƒ∞zleme Periyodu (saniye):',
        'network_interval': 'Network Kontrol Periyodu (saniye):',
        'top_apps_count': 'En √ßok kullanan uygulama sayƒ±sƒ±:',
        'auto_log': 'Otomatik Log Kaydet',
        'webhook_settings': 'üîî Webhook Ayarlarƒ±',
        'start_monitoring': 'ƒ∞zlemeyi Ba≈ülat',
        'stop_monitoring': 'ƒ∞zlemeyi Durdur',
        'network_health_check': 'Network Health Check',
        'auto_network_monitoring': 'Otomatik Network ƒ∞zleme',
        'stop_auto_network': 'Otomatik Network ƒ∞zlemeyi Durdur',
        'resource_temp_monitor': 'Resource & Temp Monitor',
        'cpu_stress_test': 'CPU Stress Test',
        'system_info_frame': 'Sistem Bilgileri',
        'cpu_usage': 'CPU Kullanƒ±mƒ±: --',
        'ram_usage': 'RAM Kullanƒ±mƒ±: --',
        'network_status': 'Network Durumu: --',
        'top_cpu_apps': 'En √áok CPU Kullanan Uygulamalar',
        'top_network_apps': 'En √áok Network Kullanan Uygulamalar',
        'system_logs': 'Sistem Log Kayƒ±tlarƒ±',
        'network_logs': 'Network Log Kayƒ±tlarƒ±',
        'clear_system_logs': 'Sistem Log Temizle',
        'export_system_logs': 'Sistem Log Export',
        'clear_network_logs': 'Network Log Temizle',
        'export_network_logs': 'Network Log Export',
        
        # Resource & Temperature Monitor
        'resource_temp_title': 'Kaynak & Sƒ±caklƒ±k Monit√∂r√º',
        'log_settings': 'Log Ayarlarƒ±',
        'enable_logging': 'Log Kaydƒ±nƒ± Etkinle≈ütir',
        'log_interval': 'Log Aralƒ±ƒüƒ± (sn):',
        'log_status_active': 'Log: Aktif',
        'log_status_inactive': 'Log: Pasif',
        'open_log_folder': 'üìÅ Log Klas√∂r√ºn√º A√ß',
        'cpu_header': 'CPU',
        'gpu_header': 'GPU',
        'ram_header': 'RAM',
        'usage': 'Kullanƒ±m: - %',
        'temperature': 'Sƒ±caklƒ±k: - ¬∞C',
        'min_temp': 'Min: - ¬∞C',
        'max_temp': 'Max: - ¬∞C',
        'usage_percent': 'Kullanƒ±m (%): - %',
        'usage_mb': 'Kullanƒ±m (MB): - / - MB',
        'gpu_util_not_available': 'GPUtil k√ºt√ºphanesi y√ºkl√º deƒüil.',
        'gpu_install_hint': 'pip install gputil',
        
        # CPU Stress Test
        'stress_test_title': 'CPU Stres Testi',
        'core_count': 'Kullanƒ±lacak √áekirdek Sayƒ±sƒ±:',
        'start_test': 'Testi Ba≈ülat',
        'stop_test': 'Testi Durdur',
        'status_waiting': 'Durum: Beklemede',
        'status_running': 'Durum: {0} √ßekirdek ile √ßalƒ±≈üƒ±yor...',
        'status_stopped': 'Durum: Durduruldu.',
        'performance_scores': 'Performans Puanlarƒ±',
        'current_score': 'Mevcut Puan: --',
        'average_score': 'Ortalama Puan: --',
        'max_score': 'En Y√ºksek Puan: --',
        'test_duration': 'Test S√ºresi: 00:00',
        
        # Standalone Stress Test
        'stress_standalone_title': 'CPU Stress Test',
        'core_count_label': '√áekirdek Sayƒ±sƒ±:',
        'start_button': 'Ba≈ülat',
        'stop_button': 'Durdur',
        'status_waiting_standalone': 'Durum: Beklemede',
        'status_running_standalone': 'Durum: {0} s√ºre√ß √ßalƒ±≈üƒ±yor',
        'status_completed': 'Tamamlandƒ± - Ort: {0:.0f}, Max: {1:.0f}',
        'status_stopped_standalone': 'Durum: Durduruldu',
        'total_cpu': 'Toplam CPU: {0:.1f} %',
        'performance_frame': 'Performans',
        'current_label': 'Mevcut: --',
        'average_label': 'Ort: --',
        'max_label': 'Max: --',
        'duration_label': 'S√ºre: 00:00',
        'per_core_usage': '√áekirdek Bazlƒ± Kullanƒ±m (%):',
        
        # Log Messages
        'log_cleared': 'Log kayƒ±tlarƒ± temizlendi',
        'monitoring_started': 'ƒ∞zleme ba≈ülatƒ±ldƒ± - {0} saniye aralƒ±klarla g√ºncelleme',
        'monitoring_stopped': 'ƒ∞zleme durduruldu - Kullanƒ±m bilgileri sƒ±fƒ±rlandƒ±',
        'network_monitoring_started': 'Otomatik network izleme ba≈ülatƒ±ldƒ± - {0} saniye aralƒ±klarla',
        'network_monitoring_stopped': 'Otomatik network izleme durduruldu',
        'resource_monitor_opened': 'Kaynak & Sƒ±caklƒ±k Monit√∂r√º a√ßƒ±ldƒ±.',
        'stress_test_started': 'CPU Stres Testi {0} √ßekirdek ile ba≈ülatƒ±ldƒ±.',
        'stress_test_stopped': 'CPU Stres Testi durduruldu.',
        'stress_test_completed': 'CPU Stres Testi tamamlandƒ±. S√ºre: {0:02d}:{1:02d}, Ort. Puan: {2:.1f}, Max Puan: {3:.1f}',
        'top_apps_updated': 'En √ßok kullanan uygulama sayƒ±sƒ± {0} olarak g√ºncellendi',
        'auto_logging_enabled': 'Otomatik log kaydetme etkin: 500KB\'a ula≈üƒ±nca yeni dosya a√ßƒ±lacak(1 dakikada bir yazƒ±lƒ±r)',
        'auto_logging_disabled': 'Otomatik log kaydetme devre dƒ±≈üƒ± - dosya yazƒ±mƒ± durdu',
        'network_auto_logging_enabled': 'Otomatik network log kaydetme etkin: 500KB\'a ula≈üƒ±nca yeni dosya a√ßƒ±lacak',
        'network_auto_logging_disabled': 'Otomatik network log kaydetme devre dƒ±≈üƒ± - dosya yazƒ±mƒ± durdu',
        
        # Network Health
        'network_health_header': '=== Network Health Check ===',
        'health_check_completed': '=== Health Check Tamamlandƒ± ===',
        'network_connection_error': 'NETWORK CONNECTION ERROR',
        'all_connections_ok': 'ALL NETWORK CONNECTIONS OK',
        'partial_connection': 'PARTIAL NETWORK CONNECTION ({0}/{1} OK)',
        'connection_ok': 'Network Connection OK',
        'connection_nok': 'NETWORK CONNECTION NOK ERROR',
        'partial_nok': 'NETWORK CONNECTION PARTIAL NOK ERROR',
        'host_status': 'HOST STATUS - {0}: {1}',
        'reachable': '‚úì Eri≈üilebilir',
        'unreachable': '‚úó Eri≈üilemiyor',
        
        # Dialogs and Messages
        'warning': 'Uyarƒ±',
        'error': 'Hata',
        'success': 'Ba≈üarƒ±lƒ±',
        'confirm': 'Onay',
        'log_folder_not_found': 'Log Klas√∂r√º Bulunamadƒ±',
        'log_folder_message': 'Log klas√∂r√º mevcut deƒüil.\n\nL√ºtfen loglama√ß ba≈ülatƒ±nƒ±z.',
        'log_folder_error': 'Log klas√∂r√º a√ßƒ±lƒ±rken hata olu≈ütu: {0}',
        'export_success': 'Log dosyasƒ± kaydedildi: {0}',
        'export_error': 'Log export edilirken hata olu≈ütu: {0}',
        
        # Language Toggle
        'language_english': 'English',
        'language_turkish': 'T√ºrk√ße',

        # --- Eklenen: CPU Stres Testi ek etiketler ---
        'per_core_score': '√áekirdek Ba≈üƒ±na Puan:',
        'sustainability': 'S√ºrd√ºr√ºlebilirlik:',
        'current_cpu_score': 'Anlƒ±k CPU Puanƒ±: {0:.2f} MOp/s',
        'per_core_cpu_score': '√áekirdek Ba≈üƒ±na Puan: {0:.2f} MOp/s',
        'average_cpu_score': 'Ortalama CPU Puanƒ±: {0:.2f} MOp/s',
        'peak_cpu_score': 'Zirve CPU Puanƒ±: {0:.2f} MOp/s',
        'sustainability_value': 'S√ºrd√ºr√ºlebilirlik: {0:.1f}%',
        'test_duration_label': 'Test S√ºresi: {0:02d}:{1:02d}',

        # --- Eklenen: Webhook pencere etiketleri/mesajlarƒ± ---
        'webhook_window_title': 'Webhook Ayarlarƒ±',
        'name_label': 'Ad:',
        'url_label': 'URL:',
        'type_label': 'T√ºr:',
        'active_label': 'Aktif',
        'threshold_label': 'E≈üik (%):',
        'mode_add_new': 'Mod: Yeni Ekle',
        'mode_editing': "Mod: D√ºzenleme '{0}'",
        'add_new_btn': 'Yeni Ekle',
        'save_changes_btn': 'Deƒüi≈üiklikleri Kaydet',
        'cancel_edit_btn': 'D√ºzenlemeyi ƒ∞ptal',
        'send_test_btn': 'Test G√∂nder',
        'remove_selected_btn': 'Se√ßileni Kaldƒ±r',
        'close_btn': 'Kapat',
        'validation_title': 'Doƒürulama',
        'validation_name_url_required': 'Ad ve URL gereklidir.',
        'duplicate_title': 'Kopya',
        'duplicate_exists': "'{0}' adlƒ± webhook zaten var. D√ºzenlemek i√ßin se√ßin veya yeni bir ad kullanƒ±n.",
        'threshold_number_error': 'E≈üik bir sayƒ± olmalƒ±dƒ±r.',
        'duplicate_rename_error': "'{0}' adlƒ± ba≈üka bir webhook mevcut.",
        'test_title': 'Test',
        'test_select_warning': 'En az bir webhook se√ßin.',
        'test_results_title': 'Test Sonu√ßlarƒ±',
        'test_results_message': 'G√∂nderildi: {0}\nBa≈üarƒ±sƒ±z: {1}',
        'test_message_title': 'üîî Test Webhook Mesajƒ±',
        'test_message_body': "Bu bir test mesajƒ±dƒ±r ('{0}').\n\nT√ºr: {1}\nAktif: {2}\nZaman: {3}",
        # --- Eklenen: Network Ayar Penceresi ---
        'network_settings_title': 'Network Ayarlarƒ±',
        'host_list_label': 'Test Hostlarƒ±:',
        'host_name_label': 'Ad:',
        'host_address_label': 'Adres:',
        'add_host_btn': 'Host Ekle',
        'remove_host_btn': 'Se√ßileni Kaldƒ±r',
        'reset_hosts_btn': 'Varsayƒ±lanlara D√∂n',
        'close_window_btn': 'Kapat',
        'host_add_warning_title': 'Doƒürulama',
        'host_add_warning_msg': 'Ad ve adres gerekli.',
        'host_remove_warning_title': 'Se√ßim',
        'host_remove_warning_msg': 'Kaldƒ±rmak i√ßin en az bir host se√ßin.',
        'hosts_reset_info_title': 'Sƒ±fƒ±rla',
        'hosts_reset_info_msg': 'Host listesi varsayƒ±lanlara d√∂nd√ºr√ºld√º.',
    }
}


class LanguageManager:
    """Language management class for internationalization support."""
    
    def __init__(self):
        self.current_language = 'en'  # Default to English
        self.config_file = 'language_config.json'
        self.load_language_preference()
        
    def get_text(self, key: str) -> str:
        """Get translated text for the specified key."""
        return LANGUAGE_DICT[self.current_language].get(key, key)
    
    def set_language(self, language: str):
        """Change language."""
        if language in LANGUAGE_DICT:
            self.current_language = language
            self.save_language_preference()
    
    def get_current_language(self) -> str:
        """Get current language."""
        return self.current_language
    
    def save_language_preference(self):
        """Save language preference to file."""
        try:
            with open(self.config_file, 'w', encoding='utf-8') as f:
                json.dump({'language': self.current_language}, f)
        except Exception:
            pass  # Silent fail
    
    def load_language_preference(self):
        """Load language preference from file."""
        try:
            if os.path.exists(self.config_file):
                with open(self.config_file, 'r', encoding='utf-8') as f:
                    data = json.load(f)
                    self.current_language = data.get('language', 'en')
        except Exception:
            self.current_language = 'en'  # Default to English


# Global language manager instance
language_manager = LanguageManager()